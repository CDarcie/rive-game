<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Game 1 - Rive</title>

  <!-- Rive Web Player (Canvas runtime) -->
  <script src="https://unpkg.com/@rive-app/canvas@2.17.3"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: #000;
      overflow: hidden;
    }
    canvas {
      display: block;
      width: 100vw;
      height: 100vh;
    }
    .hint {
      position: fixed;
      left: 12px;
      bottom: 12px;
      color: #bbb;
      font: 12px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      user-select: none;
    }
  </style>
</head>
<body>
  <canvas id="riveCanvas"></canvas>
  <div class="hint">Tip: open DevTools (F12) → Console for helpful logs.</div>

  <script>
    // ---- CONFIG: set ONE of these to match your Rive file ----
    // If your file uses a state machine (recommended):
    const STATE_MACHINE = "SM_1"; // e.g. "State Machine 1"
    // If your file uses a timeline animation instead:
    const ANIMATION = ""; // e.g. "Idle" or "Main"
    // ----------------------------------------------------------

    const canvas = document.getElementById("riveCanvas");

    // Ensure crisp rendering on HiDPI screens.
    function resizeCanvas() {
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      canvas.width = Math.round(rect.width * dpr);
      canvas.height = Math.round(rect.height * dpr);
    }
    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);

    // Safety check: running from file:// often blocks fetch
    if (location.protocol === "file:") {
      console.warn(
        "You're opening this over file://. Start a local server, e.g.:\n" +
        "python3 -m http.server 8080  (then visit http://localhost:8080/)"
      );
    }

    // Create and load the Rive file
    try {
      const r = new rive.Rive({
        src: "game1.riv",
        canvas,
        autoplay: true,
        // Provide exactly one of these depending on how your file is authored:
        stateMachines: STATE_MACHINE ? [STATE_MACHINE] : [],
        animations: (!STATE_MACHINE && ANIMATION) ? [ANIMATION] : [],
        fit: rive.Fit.CONTAIN,
        alignment: rive.Alignment.CENTER,

        onLoad: () => {
          console.log("Rive file loaded.");
          // If nothing is configured above, try to play the first animation
          // (This is a best-effort fallback and may not work for all files.)
          try {
            if (!STATE_MACHINE && !ANIMATION) {
              console.log("No state machine/animation specified; attempting fallback playback.");
              // Some versions expose play() without args to resume default;
              // If your file has no default, set STATE_MACHINE or ANIMATION above.
              r.play();
            }
          } catch (e) {
            console.warn("Fallback play() failed. Set STATE_MACHINE or ANIMATION.", e);
          }
        },

        onPlay: () => console.log("Playing…"),
        onPause: () => console.log("Paused."),
        onStop: () => console.log("Stopped."),
        onError: (err) => console.error("Rive error:", err),
      });
    } catch (e) {
      console.error("Failed to initialize Rive:", e);
    }
  </script>
</body>
</html>
